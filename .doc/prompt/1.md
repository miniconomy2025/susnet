I have the following MongoDB schema for a Reddit clone I'm building:
[](/)



I have defined the following endpoint request/response type schemas:

[Generic types](/types/types.ts)
[API endpoint types](/types/api.ts)



Write the implementations for all of the above endpoints as a set of utility functions which take the request as a `Req_*` object, and return a `Res_*` object in response.
Favour writing everything as a single Mongoose query where possible, so that all the data is fetched & returned at once.
Place all of the utility functions in a map which looks as follows:

```ts
type ReqType = "GET" | "POST" | "PATCH" | "DELETE";
type Endpoints = { [K in `${ReqType}|/${string}`]: (params: object) => Promise<object> }
const endpoints = {
    "GET|/health": ...,
    "POST|/auth/login": ...,
    "GET|/auth/me": ...,
    "GET|/actors/:name": ...,
    "GET|/actors/:name/posts": ...,
    "GET|/actors/:name/followers": ...,
    "GET|/actors/:name/following": ...,
    "GET|/actors/:name/aggregate": ...,
    "POST|/actors/subs": ...,
    "PATCH|/actors/me": ...,
    "GET|/posts/:postId": ...,
    "GET|/posts/:postId/votes": ...,
    "POST|/posts": ...,
    "POST|/posts/:postId/vote": ...,
    "POST|/actors/:targetName/follow": ...,
    "DELETE|/actors/:targetName/follow": ...,
    "GET|/actors/:targetName/following-status": ...,
    "POST|/api/posts/feed": ...,
    "POST|/api/actors/search": ...,
    "POST|/api/tags/search": ...,
    "PATCH|/api/posts/:postId": ...,
    "PATCH|/api/actors/:actorName": ...,
}
```

